<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
  <head>
    <title>Tor Metrics Portal: HOWTO</title>
    <meta http-equiv=Content-Type content="text/html; charset=iso-8859-1">
    <link href="http://www.torproject.org/stylesheet-ltr.css" type=text/css rel=stylesheet>
    <link href="http://www.torproject.org/favicon.ico" type=image/x-icon rel="shortcut icon">
  </head>
  <body>
    <div class="center">
      <table class="banner" border="0" cellpadding="0" cellspacing="0" summary="">
        <tr>
          <td class="banner-left"><a href="https://www.torproject.org/"><img src="http://www.torproject.org/images/top-left.png" alt="Click to go to home page" width="193" heigth="79"></a></td>
          <td class="banner-middle">
            <a href="/">Home</a>
            <a href="graphs.html">Graphs</a>
            <a href="papers.html">Papers</a>
            <a href="data.html">Data</a>
            <a class="current">Tools</a>
          </td>
          <td class="banner-right"></td>
        </tr>
      </table>
      <div class="main-column">
        <h2>Tor Metrics Portal: HOWTO</h2>
        <br/>
        <p>The main task of ERNIE is to process Tor data from various
        sources to make it useful for statistical analysis. This HOWTO
        explains the various data sources that ERNIE can process and the
        data sinks that it writes its results to.</p>
        <br/>
        <h3>Overview of data sources and sinks</h3>
        <p><img src="ernie.jpg"/></p>
        <br/>
        <h3>Data sources</h3>
        <ul>
          <li>Relay descriptors: Relay descriptors subsume all documents
          that relays and the directory authorities publish. There are
          four types of relay descriptors: server descriptors, extra-info
          descriptors, and network status votes and consensuses (short:
          votes and consensuses). Relay descriptors can come from at least
          three different sources:</li>
          <ul>
            <li>Local Tor data directory: Every Tor client downloads most
            of the relay descriptors in order to build circuits. The
            cached-* files that can be found in a Tor data directory can
            be parsed to learn about recent relay descriptors.</li>
            <li>Directory archive: There are two tools that collect relay
            descriptors and write them to a directory structure: the
            directory-archive script that can be found in
            contrib/directory-archive/ in the Tor sources and ERNIE (with
            the Directory archive data sink).</li>
            <li>Download from directory authorities: Recent relay
            descriptors can be downloaded from the directory authorities
            (or directory mirrors in theory) via HTTP.</li>
          </ul>
          <li>Bridge descriptors: Bridge descriptors consist of the same
          documents as relay descriptors, but are published by bridge
          relays to the bridge authority. There are two sources for bridge
          descriptors:</li>
          <ul>
            <li>Sanitized bridge descriptors: Bridge descriptors in their
            original form contain sensitive information like IP addresses
            and bridge identities that can be used to find out bridge IP
            addresses. We provide sanitized bridge descriptors that have
            all potentially sensitive data removed. One way to sanitize
            bridge descriptors is to use ERNIE (with the Sanitized bridge
            descriptors data sink).</li>
            <li>Bridge descriptor snapshots: The bridge authority takes
            half-hourly snapshots of the bridge descriptors in its data
            directory. These (unsanitized) bridge descriptors can be the
            input to produce sanitized bridge descriptors for later
            publication.</li>
          </ul>
          <li>Torperf output files: The torperf tool measures the
          user-perceived performance of the Tor network and writes its
          results to text files. These files can be the input for
          generating torperf statistics.</li>
          <li>Download raw GetTor statistics: GetTor allows users to fetch
          Tor via email. GetTor provides basic statistics about delivered
          packages per day which can be transformed into CSV files for
          generating GetTor statistics.</li>
          <li>Download exit list: The exit list contains a list of IP
          addresses of exit relays. These IP addresses can be different
          from the IP addresses that relays use to be contacted from
          within the Tor network. Currently, the downloaded exit lists are
          written to a local directory structure for later analysis.</li>
        </ul>
        <br>
        <h3>Data sinks</h3>
        <ul>
          <li>Directory archive: The directory archive contains all types
          of relay descriptors, sorted into a local directory structure.
          The main purpose of directory archives is to make them available
          as data source for others.</li>
          <li>Descriptor database: A local descriptor database can be used
          to import both relay and bridge descriptors from the various
          data sources. Often, performing ad-hoc analyses is easier with a
          database instead of developing a statistics file format first
          including files for intermediate results.</li>
          <li>Sanitized bridge descriptors: The sanitized bridge
          descriptors are the result of stripping of all potentially
          sensitive data from bridge descriptor snapshots. The descriptors
          are sorted into a directory structure similar to the relay
          descriptor directory structure.</li>
          <li>Statistics files: The statistics files are CSV files that
          have been designed for later analysis with R or other statistics
          tools. There are various statistics files, depending on the data
          that shall be analyzed:</li>
          <ul>
            <li>Consensus statistics: Consensus statistics contain
            aggregated data extracted from relay consensuses and bridge
            statuses. For every day the consensus statistics list the
            number of running relays with certain flags assigned by the
            directory authorities and the number of running bridges.</li>
            <li>Directory request statistics: The directory authorities
            and directory mirrors learn from client requests how many
            users there are from which countries per day. The directory
            request statistics contain these user numbers for a given list
            of directory authorities/mirrors.</li>
            <li>Bridge usage statistics: Bridges record unique IP
            addresses by country to obtain rough user numbers. The bridge
            usage statistics accumulate user numbers by country per
            day.</li>
            <li>Server descriptor statistics: Relays advertise some of
            their capabilities in their server descriptors. The server
            descriptor statistics combine these server descriptors with
            the consensuses to obtain statistics on running relays, e.g.,
            software version, operating system, or advertised
            bandwidth.</li>
            <li>Torperf statistics: The torperf statistics contain an
            aggregated version of the torperf output files. For every
            date, the torperf statistics file contains median, first and
            third quartile of download times on that date.</li>
            <li>GetTor statistics: The GetTor statistics file contains the
            number of delivered package by type and date.</li>
          </ul>
          <li>Exit list archive: The exit list archive is a local
          directory structure containing a separate file for every
          downloaded exit list.</li>
        </ul>
      </div>
    </div>
    <div class="bottom" id="bottom">
      <p>"Tor" and the "Onion Logo" are <a href="https://www.torproject.org/trademark-faq.html.en">registered trademarks</a> of The Tor Project, Inc.</p>
    </div>
  </body>
</html>

